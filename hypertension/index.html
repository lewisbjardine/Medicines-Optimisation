<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hypertension – medication picker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../shared/styles.css">
<style>
main{max-width:1200px;margin:1.2rem auto;padding:1rem;background:#fff;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
.small{font-size:.8rem}
.section{margin-top:1.2rem}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:1.2rem}
.matrix{border:1px solid var(--nhs-border);border-radius:4px;overflow:hidden}
.row{display:grid;grid-template-columns:180px repeat(6,1fr) 120px;gap:.25rem;padding:.4rem;border-bottom:1px solid #eee;align-items:center;font-size:.78rem}
.row:last-child{border-bottom:none}
.header-row{background:#f0f4f5;font-weight:bold}
.dose-btn{padding:.2rem .35rem;border:1px solid var(--nhs-border);border-radius:4px;text-align:center;cursor:pointer;user-select:none}
.dose-btn.current{background:#e8f4ff;border-color:#0072ce;font-weight:bold}
.dose-btn.blocked{background:#f5f5f5;color:#888;text-decoration:line-through}
.block-btn{font-size:.7rem}
.instructions{background:#f0f4f5;border-left:4px solid #0072ce;padding:.5rem;margin-bottom:.8rem;font-size:.8rem}
</style>
</head>
<body>

<header>
<h1>Hypertension management assistant</h1>
<p class="subtitle">ABCD-aligned antihypertensive review</p>
<a href="../index.html" class="return-home">Back to home</a>
</header>

<main>

<div class="instructions">
<strong>How to use:</strong>
• <strong>Click</strong> a dose to select / unselect the current dose<br>
• <strong>Double‑click</strong> a dose to mark it as <em>not tolerated</em> (blocked)<br>
• <strong>Click again</strong> on a blocked dose to reset it
</div>

<section class="card small">
<h2>1. Patient factors</h2>
<div class="grid">
  <div>
    <label>Age band</label>
    <select>
      <option>&lt;55</option>
      <option selected>55–79</option>
      <option>≥80</option>
    </select>
  </div>
  <div>
    <label>Ethnicity</label>
    <select>
      <option>White / Other</option>
      <option>Black African or Caribbean</option>
    </select>
  </div>
  <div>
    <label>Risk factors</label>
    <select multiple size="4">
      <option>Diabetes</option>
      <option>CKD</option>
      <option>Proteinuria</option>
      <option>Ischaemic heart disease</option>
    </select>
    <div class="hint">Hold Ctrl / Cmd to select multiple</div>
  </div>
</div>
</section>

<section class="card section small">
<h2>2. Current antihypertensive treatment</h2>

<div class="grid-2">
  <div>
    <h3>A – ACE inhibitors</h3>
    <div class="matrix" id="ACE"></div>
    <h3 style="margin-top:.8rem">A – ARBs</h3>
    <div class="matrix" id="ARB"></div>
  </div>
  <div>
    <h3>C – Calcium-channel blockers</h3>
    <div class="matrix" id="CCB"></div>
    <h3 style="margin-top:.8rem">D – Thiazide / thiazide-like</h3>
    <div class="matrix" id="THZ"></div>
    <h3 style="margin-top:.8rem">Other / Step 4</h3>
    <div class="matrix" id="OTH"></div>
  </div>
</div>
</section>

</main>

<script>
const DATA = {
 ACE: [
  ["Lisinopril",["2.5","5","10","20","30","40"]],
  ["Perindopril",["2","4","6","8"]],
  ["Ramipril",["1.25","2.5","5","10"]],
  ["Captopril",["6.25","12.5","25","50","75"]],
  ["Enalapril",["2.5","5","10","20","40"]],
  ["Fosinopril",["10","20","40"]],
  ["Imidapril",["2.5","5","10","20"]],
  ["Trandolapril",["0.5","1","2","4"]]
 ],
 ARB: [
  ["Candesartan",["4","8","16","32"]],
  ["Irbesartan",["75","150","225","300"]],
  ["Losartan",["25","50","100"]],
  ["Azilsartan",["20","40","80"]],
  ["Eprosartan",["600"]],
  ["Olmesartan",["10","20","40"]],
  ["Telmisartan",["20","40","80"]],
  ["Valsartan",["40","80","160","240"]]
 ],
 CCB: [
  ["Amlodipine",["5","10"]],
  ["Felodipine MR",["2.5","5","10","20"]],
  ["Lacidipine",["2","4","6"]],
  ["Lercanidipine",["10","20"]],
  ["Nicardipine",["20","30","40"]],
  ["Nifedipine MR",["30","60","90"]]
 ],
 THZ: [
  ["Indapamide",["2.5"]],
  ["Chlortalidone",["25","50"]],
  ["Metolazone",["2.5","5"]],
  ["Xipamide",["20"]],
  ["Bendroflumethiazide",["2.5"]]
 ],
 OTH: [
  ["Spironolactone",["25"]],
  ["Doxazosin",["1","2","4"]],
  ["Terazosin",["1","2","5","10"]],
  ["Bisoprolol",["2.5","5","10"]],
  ["Carvedilol",["12.5","25","50"]],
  ["Nebivolol",["2.5","5"]],
  ["Atenolol",["25","50"]],
  ["Metoprolol",["100","200"]],
  ["Propranolol",["80","160"]],
  ["Timolol",["5","10","20","30"]]
 ]
};

const state = {};

function renderSection(id){
 const box=document.getElementById(id);
 box.innerHTML="";
 const header=document.createElement("div");
 header.className="row header-row";
 header.innerHTML="<div>Drug</div>"+Array(6).fill("<div>Dose</div>").join("")+"<div></div>";
 box.appendChild(header);

 DATA[id].forEach(([name,doses])=>{
  if(!state[name]) state[name]={c:null,b:new Set(),bd:false};
  const s=state[name];
  const row=document.createElement("div");
  row.className="row";
  row.appendChild(Object.assign(document.createElement("div"),{textContent:name}));

  for(let i=0;i<6;i++){
    const cell=document.createElement("div");
    if(doses[i]){
      const btn=document.createElement("div");
      btn.className="dose-btn";
      btn.textContent=doses[i]+" mg";

      if(s.c===doses[i]) btn.classList.add("current");
      if(s.b.has(doses[i])) btn.classList.add("blocked");

      btn.onclick=()=>{
        if(s.b.has(doses[i])){
          s.b.delete(doses[i]); // reset
        } else {
          s.c = (s.c===doses[i]) ? null : doses[i];
        }
        renderAll();
      };

      btn.ondblclick=()=>{
        if(s.c===doses[i]) s.c=null;
        s.b.add(doses[i]);
        renderAll();
      };

      cell.appendChild(btn);
    }
    row.appendChild(cell);
  }

  const block=document.createElement("button");
  block.className="secondary block-btn";
  block.textContent=s.bd?"Unblock":"Block";
  block.onclick=()=>{
    s.bd=!s.bd;
    if(s.bd){
      s.c=null;
      s.b=new Set(doses);
    } else s.b.clear();
    renderAll();
  };

  row.appendChild(block);
  box.appendChild(row);
 });
}

function renderAll(){
 renderSection("ACE");
 renderSection("ARB");
 renderSection("CCB");
 renderSection("THZ");
 renderSection("OTH");
}

renderAll();
</script>

</body>
</html>
